---
title: tRPC
description: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ tRPC
layout: ../../../layouts/docs.astro
lang: ru
---

tRPC –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –ø–∏—Å–∞—Ç—å —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ API –æ—Ç –∫–æ–Ω—Ü–∞ –¥–æ –∫–æ–Ω—Ü–∞ (end-to-end) –±–µ–∑ –∫–∞–∫–æ–π-–ª–∏–±–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞ –∏–ª–∏ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ç–ª–∏—á–Ω—É—é –∏–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—é TypeScript –¥–ª—è –≤—ã–≤–æ–¥–∞ —Ç–∏–ø–æ–≤ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞ –≤–∞—à–µ–≥–æ API –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—ã API –∏–∑ –≤–∞—à–µ–≥–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ —Å –ø–æ–ª–Ω–æ–π —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –∏ –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º. –ò—Å–ø–æ–ª—å–∑—É—è tRPC, –≤–∞—à —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∏ –±—ç–∫–µ–Ω–¥ —á—É–≤—Å—Ç–≤—É—é—Ç —Å–µ–±—è –±–ª–∏–∂–µ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É, —á–µ–º –∫–æ–≥–¥–∞-–ª–∏–±–æ, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π –æ–ø—ã—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞.

<blockquote className="w-full relative border-l-4 italic bg-t3-purple-200 dark:text-t3-purple-50 text-zinc-900 dark:bg-t3-purple-300/20 p-2 rounded-md text-sm my-3 border-neutral-500 quote">
  <div className="relative w-fit flex items-center justify-center p-1">
    <p className="mb-4 text-lg">
      <span aria-hidden="true">&quot;</span>I built tRPC to allow people to move faster by removing the need of a traditional API-layer, while still having confidence that our apps won't break as we rapidly iterate.<span aria-hidden="true">&quot;</span>
    </p>
  </div>
  <cite className="flex items-center justify-end pr-4 pb-2">
    <img
      alt="Avatar of @alexdotjs"
      className="w-12 rounded-full bg-neutral-500 [margin-inline-end:16px]"
      src="https://avatars.githubusercontent.com/u/459267?v=4"
    />
    <div className="flex flex-col items-start not-italic">
      <span className=" text-sm font-semibold">Alex - creator of tRPC</span>
      <a
        href="https://twitter.com/alexdotjs"
        target="_blank"
        rel="noopener noreferrer"
        className="text-sm"
      >
        @alexdotjs
      </a>
    </div>
  </cite>
</blockquote>

## –§–∞–π–ª—ã

tRPC —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π `create-t3-app` –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –¥–ª—è –≤–∞—Å. –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è:

### üìÑ `pages/api/trpc/[trpc].ts`

–≠—Ç–æ—Ç —Ñ–∞–π–ª —è–≤–ª—è–µ—Ç—Å—è —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ –¥–ª—è –≤–∞—à–µ–≥–æ API –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤–∞—à tRPC —Ä–æ—É—Ç–µ—Ä. –û–±—ã—á–Ω–æ, –≤–∞–º –Ω–µ –ø—Ä–∏–¥–µ—Ç—Å—è —Ç—Ä–æ–≥–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª, –Ω–æ –µ—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∫–ª—é—á–∏—Ç—å CORS middleware –∏–ª–∏ —á—Ç–æ —Ç–æ –ø–æ–¥–æ–±–Ω–æ–µ, –ø–æ–ª–µ–∑–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–π `createNextApiHandler` - —ç—Ç–æ [Next.js API handler](https://nextjs.org/docs/api-routes/introduction) –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç [request](https://developer.mozilla.org/en-US/docs/Web/API/Request) –∏ [response](https://developer.mozilla.org/en-US/docs/Web/API/Response) –æ–±—ä–µ–∫—Ç. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –æ–±–µ—Ä–Ω—É—Ç—å `createNextApiHandler` –≤ –ª—é–±–æ–π middleware, –∫–æ—Ç–æ—Ä—ã–π –≤–∞–º –Ω—É–∂–µ–Ω. –°–º. –Ω–∏–∂–µ –¥–ª—è [–ø—Ä–∏–º–µ—Ä–∞](#enabling-cors) –¥–æ–±–∞–≤–ª–µ–Ω–∏—è CORS.

### üìÑ `server/api/trpc.ts`

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏: —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è tRPC.

1. –ú—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤–∞—à–∏–º tRPC –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º. –ö–æ–Ω—Ç–µ–∫—Å—Ç - —ç—Ç–æ –¥–∞–Ω–Ω—ã–µ, –∫ –∫–æ—Ç–æ—Ä—ã–º —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –≤–æ –≤—Å–µ—Ö –≤–∞—à–∏—Ö tRPC –ø—Ä–æ—Ü–µ–¥—É—Ä–∞—Ö, –∏ —ç—Ç–æ –æ—Ç–ª–∏—á–Ω–æ–µ –º–µ—Å—Ç–æ, —á—Ç–æ–±—ã –ø–æ–º–µ—Å—Ç–∏—Ç—å –≤–µ—â–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Ç.–¥. –í create-t3-app –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±—ä–µ–∫—Ç—É –∑–∞–ø—Ä–æ—Å–∞.

- `createInnerTRPCContext`: –≠—Ç–æ —Ç–æ –º–µ—Å—Ç–æ, –≥–¥–µ –≤—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–ø—Ä–æ—Å–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∞—à–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è [–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](#sample-integration-test) –∏–ª–∏ [ssg-–ø–æ–º–æ—â–Ω–∏–∫–æ–≤](https://trpc.io/docs/v10/ssg-helpers), –≥–¥–µ —É –≤–∞—Å –Ω–µ—Ç –æ–±—ä–µ–∫—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞.

- `createTRPCContext`: –ó–¥–µ—Å—å –≤—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–ø—Ä–æ—Å–∞: –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–µ—Å—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –í—ã –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç–µ —Å–µ—Å—Å–∏—é —Å –ø–æ–º–æ—â—å—é –æ–±—ä–µ–∫—Ç–∞ `opts.req`, –∞ –∑–∞—Ç–µ–º –ø–µ—Ä–µ–¥–∞–µ—Ç–µ —Å–µ—Å—Å–∏—é –≤ —Ñ—É–Ω–∫—Ü–∏—é `createInnerTRPCContext` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

2. –ú—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º tRPC –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ [–ø—Ä–æ—Ü–µ–¥—É—Ä—ã](https://trpc.io/docs/v10/procedures) –∏ [–ø–æ—Å—Ä–µ–¥–Ω–∏–∫–∏](https://trpc.io/docs/v10/middlewares). –ü–æ —Å–æ–≥–ª–∞—à–µ–Ω–∏—é, –≤—ã –Ω–µ –¥–æ–ª–∂–Ω—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –æ–±—ä–µ–∫—Ç `t`, –∞ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–∏ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö.

–í—ã –∑–∞–º–µ—Ç–∏—Ç–µ —á—Ç–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º `superjson` –∫–∞–∫ [–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å –¥–∞–Ω–Ω—ã—Ö](https://trpc.io/docs/v10/data-transformers). –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ–≥–¥–∞ –æ–Ω–∏ –¥–æ—Å—Ç–∏–≥–∞—é—Ç –∫–ª–∏–µ–Ω—Ç–∞, –ø–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –≤—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç–µ –æ–±—ä–µ–∫—Ç `Date`, –∫–ª–∏–µ–Ω—Ç –≤–µ—Ä–Ω–µ—Ç `Date`, –∞ –Ω–µ —Å—Ç—Ä–æ–∫—É, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Å–ª—É—á–∞–µ–º –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ API.

### üìÑ `server/api/routers/*.ts`

–≠—Ç–æ —Ç–æ –º–µ—Å—Ç–æ, –≥–¥–µ –≤—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –≤–∞—à–µ–≥–æ API. –í—ã [—Å–æ–∑–¥–∞–µ—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä—ã](https://trpc.io/docs/v10/router) –¥–ª—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä.

### üìÑ `server/api/root.ts`

–ó–¥–µ—Å—å –º—ã [–æ–±—ä–µ–¥–∏–Ω—è–µ–º](https://trpc.io/docs/v10/merging-routers) –≤—Å–µ –ø–æ–¥-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä—ã, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ `routers/**` –≤ –µ–¥–∏–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### üìÑ `utils/api.ts`

–≠—Ç–æ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è tRPC –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ. –ó–¥–µ—Å—å –≤—ã –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç–µ **–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤** –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞ –∏ —Å–æ–∑–¥–∞–µ—Ç–µ –∫–ª–∏–µ–Ω—Ç tRPC –≤–º–µ—Å—Ç–µ —Å —Ö—É–∫–∞–º–∏ react-query. –ü–æ—Å–∫–æ–ª—å–∫—É –º—ã –≤–∫–ª—é—á–∏–ª–∏ `superjson` –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –±—ç–∫–µ–Ω–¥–µ, –Ω–∞–º —Ç–∞–∫–∂–µ –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –µ–≥–æ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ. –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –±—ç–∫–µ–Ω–¥–∞ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ.

–ó–¥–µ—Å—å –≤—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Å–≤–æ–∏ [—Å—Å—ã–ª–∫–∏](https://trpc.io/docs/v10/links) tRPC, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –ø–æ—Ç–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º "default" [`httpBatchLink`](https://trpc.io/docs/v10/links/httpBatchLink), –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç [–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã](https://cloud.google.com/compute/docs/api/how-tos/batch), –∞ —Ç–∞–∫–∂–µ [`loggerLink`](https://trpc.io/docs/v10/links/loggerLink), –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–æ–¥–∏—Ç –ø–æ–ª–µ–∑–Ω—ã–µ –∂—É—Ä–Ω–∞–ª—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

–í –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤, –º—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º [–≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∏–ø](https://trpc.io/docs/v10/infer-types#additional-dx-helper-type), –∫–æ—Ç–æ—Ä—ã–π –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤—ã–≤–æ–¥–∞ —Ç–∏–ø–æ–≤ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ.

## –ö–∞–∫ —è –º–æ–≥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å tRPC?

<div class="embed">
<iframe width="560" height="315" src="https://www.youtube.com/embed/2LYM8gf184U" title="Making typesafe APIs easy with tRPC" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>

tRPC –∫–æ–Ω—Ç—Ä–∏–±—å—é—Ç–æ—Ä [trashh_dev](https://twitter.com/trashh_dev) [–≤—ã—Å—Ç—É–ø–∏–ª –Ω–∞ Next.js Conf](https://www.youtube.com/watch?v=2LYM8gf184U) —Å —Ä–∞—Å—Å–∫–∞–∑–æ–º –æ tRPC. –ú—ã –Ω–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–∞–º –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –µ–≥–æ, –µ—Å–ª–∏ –≤—ã –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–ª–∏ —ç—Ç–æ.

–° tRPC –≤—ã –ø–∏—à–µ—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ TypeScript –Ω–∞ –±—ç–∫–µ–Ω–¥–µ, –∞ –∑–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞–µ—Ç–µ –∏—Ö –∏–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞. –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ tRPC –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:

```ts:server/api/routers/user.ts
const userRouter = createTRPCRouter({
  getById: publicProcedure.input(z.string()).query(({ ctx, input }) => {
    return ctx.prisma.user.findFirst({
      where: {
        id: input,
      },
    });
  }),
});
```

–≠—Ç–æ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ tRPC (—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞ –≤ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–º –±—ç–∫–µ–Ω–¥–µ), –∫–æ—Ç–æ—Ä–∞—è —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é Zod (–∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è —Ç–æ–π –∂–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏, –∫–æ—Ç–æ—Ä—É—é –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è [–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è](./env-variables)) - –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º—ã —É–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —è–≤–ª—è—é—Ç—Å—è —Å—Ç—Ä–æ–∫–æ–π. –ï—Å–ª–∏ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è —Å—Ç—Ä–æ–∫–æ–π, –æ–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—É—é –æ—à–∏–±–∫—É.

–ü–æ—Å–ª–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º—ã –ø—Ä–∏–º–µ–Ω—è–µ–º resolver —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–∏–±–æ [–∑–∞–ø—Ä–æ—Å–æ–º](https://trpc.io/docs/v10/react-queries), [–º—É—Ç–∞—Ü–∏–µ–π](https://trpc.io/docs/v10/react-mutations) –∏–ª–∏ [–ø–æ–¥–ø–∏—Å–∫–æ–π](https://trpc.io/docs/v10/subscriptions). –í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ resolver –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–∞—à—É –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –∫–ª–∏–µ–Ω—Ç–∞ [prisma](./prisma) –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —É –∫–æ—Ç–æ—Ä–æ–≥–æ `id` —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–π –º—ã –ø–µ—Ä–µ–¥–∞–ª–∏.

–í—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç–µ —Å–≤–æ–∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –≤ `—Ä–æ—É—Ç–µ—Ä–∞—Ö` –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏—é —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä —Å –æ–±—â–∏–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º –∏–º–µ–Ω. –£ –≤–∞—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–∏–Ω —Ä–æ—É—Ç–µ—Ä –¥–ª—è `–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π`, –æ–¥–∏–Ω –¥–ª—è `–ø–æ—Å—Ç–æ–≤` –∏ –µ—â–µ –æ–¥–∏–Ω –¥–ª—è `—Å–æ–æ–±—â–µ–Ω–∏–π`. –≠—Ç–∏ —Ä–æ—É—Ç–µ—Ä—ã –∑–∞—Ç–µ–º –º–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ –µ–¥–∏–Ω—ã–π —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π `appRouter`:

```ts:server/api/root.ts
const appRouter = createTRPCRouter({
  users: userRouter,
  posts: postRouter,
  messages: messageRouter,
});

export type AppRouter = typeof appRouter;
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–æ, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–∏–ø—ã –Ω–∞—à–∏—Ö —Ä–æ—É—Ç–µ—Ä–æ–≤, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ.

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –≤—ã–∑–æ–≤–∏–º –ø—Ä–æ—Ü–µ–¥—É—Ä—É –Ω–∞ –Ω–∞—à–µ–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ. tRPC –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–±–µ—Ä—Ç–∫—É –¥–ª—è `@tanstack/react-query`, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ö—É–∫–æ–≤ (hooks), –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç, –Ω–æ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ–º —Ç–æ–≥–æ, —á—Ç–æ –≤–∞—à–∏ –≤—ã–∑–æ–≤—ã API —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∏ –∏–Ω—Ñ–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã (inferred). –ú—ã –º–æ–∂–µ–º –≤—ã–∑—ã–≤–∞—Ç—å –Ω–∞—à–∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Å –Ω–∞—à–µ–≥–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```tsx:pages/users/[id].tsx
import { useRouter } from "next/router";
import { api } from "../../utils/api";

const UserPage = () => {
  const { query } = useRouter();
  const userQuery = api.users.getById.useQuery(query.id);

  return (
    <div>
      <h1>{userQuery.data?.name}</h1>
    </div>
  );
};
```

–í—ã —Å—Ä–∞–∑—É –∑–∞–º–µ—Ç–∏—Ç–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–∏ –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –≤—ã –Ω–∞—á–Ω–µ—Ç–µ –ø–∏—Å–∞—Ç—å `trpc.`, –≤–∞—à–∏ —Ä–æ—É—Ç–µ—Ä—ã –ø–æ—è–≤—è—Ç—Å—è –≤ –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–∏, –∏ –∫–æ–≥–¥–∞ –≤—ã –≤—ã–±–µ—Ä–µ—Ç–µ —Ä–æ—É—Ç–µ—Ä, –µ–≥–æ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Ç–∞–∫–∂–µ –ø–æ—è–≤—è—Ç—Å—è. –í—ã —Ç–∞–∫–∂–µ –ø–æ–ª—É—á–∏—Ç–µ –æ—à–∏–±–∫—É TypeScript, –µ—Å–ª–∏ –≤–∞—à –≤–≤–æ–¥ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—É, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ.

## –ö–∞–∫ —è –º–æ–≥—É –≤—ã–∑—ã–≤–∞—Ç—å —Å–≤–æ–π API –∏–∑–≤–Ω–µ?

–í –æ–±—ã—á–Ω—ã—Ö API, –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–∑–≤–∞—Ç—å –≤–∞—à–∏ –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ (endpoints) –∏—Å–ø–æ–ª—å–∑—É—è –ª—é–±–æ–π HTTP –∫–ª–∏–µ–Ω—Ç, –∫–∞–∫ `curl`, `Postman`, `fetch` –∏–ª–∏ –ø—Ä—è–º–æ –∏–∑ –≤–∞—à–µ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞. –° tRPC, —ç—Ç–æ –Ω–µ–º–Ω–æ–≥–æ –∏–Ω–∞—á–µ. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤—ã–∑—ã–≤–∞—Ç—å –≤–∞—à–∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –±–µ–∑ –∫–ª–∏–µ–Ω—Ç–∞ tRPC, –µ—Å—Ç—å –¥–≤–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã—Ö —Å–ø–æ—Å–æ–±–∞ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ:

### –†–∞—Å–∫—Ä–æ–π—Ç–µ –æ–¥–Ω—É –ø—Ä–æ—Ü–µ–¥—É—Ä—É –≤–Ω–µ—à–Ω–µ

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Ä–∞—Å–∫—Ä—ã—Ç—å –≤–∞—à—É –ø—Ä–æ—Ü–µ–¥—É—Ä—É –≤–Ω–µ—à–Ω–µ, –≤—ã –∏—â–µ—Ç–µ [server side calls](https://trpc.io/docs/v10/server-side-calls). –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –≤–∞–º —Å–æ–∑–¥–∞—Ç—å –æ–±—ã—á–Ω—É—é –∫–æ–Ω–µ—á–Ω—É—é —Ç–æ—á–∫—É (endpoint) API Next.js, –Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á–∞—Å—Ç—å —Ä–µ–∑–æ–ª–≤–µ—Ä–∞ –≤–∞—à–µ–π tRPC –ø—Ä–æ—Ü–µ–¥—É—Ä—ã.

```ts:pages/api/users/[id].ts
import { type NextApiRequest, type NextApiResponse } from "next";
import { appRouter } from "../../../server/api/root";
import { createTRPCContext } from "../../../server/api/trpc";

const userByIdHandler = async (req: NextApiRequest, res: NextApiResponse) => {
  // Create context and caller
  const ctx = await createTRPCContext({ req, res });
  const caller = appRouter.createCaller(ctx);
  try {
    const { id } = req.query;
    const user = await caller.user.getById(id);
    res.status(200).json(user);
  } catch (cause) {
    if (cause instanceof TRPCError) {
      // An error from tRPC occured
      const httpCode = getHTTPStatusCodeFromError(cause);
      return res.status(httpCode).json(cause);
    }
    // Another error occured
    console.error(cause);
    res.status(500).json({ message: "Internal server error" });
  }
};

export default userByIdHandler;
```

### –†–∞—Å–∫—Ä–æ–π—Ç–µ –∫–∞–∂–¥—É—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É –≤–Ω–µ—à–Ω–µ

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Ä–∞—Å–∫—Ä—ã—Ç—å –∫–∞–∂–¥—É—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É –≤–Ω–µ—à–Ω–µ, –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –ø–ª–∞–≥–∏–Ω–æ–º —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ [trpc-openapi](https://github.com/jlalmes/trpc-openapi/tree/master). –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤–∞—à–∏–º –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º, –≤—ã –º–æ–∂–µ—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ REST API –∏–∑ –≤–∞—à–µ–≥–æ tRPC —Ä–æ—É—Ç–µ—Ä–∞.

### –≠—Ç–æ –≤—Å–µ–≥–æ –ª–∏—à—å HTTP –∑–∞–ø—Ä–æ—Å—ã

tRPC –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —á–µ—Ä–µ–∑ HTTP, –ø–æ—ç—Ç–æ–º—É —Ç–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –≤–∞—à–∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã tRPC –∏—Å–ø–æ–ª—å–∑—É—è "–æ–±—ã—á–Ω—ã–µ" HTTP –∑–∞–ø—Ä–æ—Å—ã. –û–¥–Ω–∞–∫–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∏—è—Ç–Ω—ã–º –∏–∑-–∑–∞ [RPC –ø—Ä–æ—Ç–æ–∫–æ–ª–∞](https://trpc.io/docs/v10/rpc), –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç tRPC. –ï—Å–ª–∏ –≤–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ tRPC –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã –≤—ã–≥–ª—è–¥—è—Ç –≤ –≤–∞—à–µ–π –≤–∫–ª–∞–¥–∫–µ —Å–µ—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞, –Ω–æ –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –¥–µ–ª–∞—Ç—å —ç—Ç–æ —Ç–æ–ª—å–∫–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∏ –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è –æ–¥–Ω–æ–≥–æ –∏–∑ —Ä–µ—à–µ–Ω–∏–π, –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤—ã—à–µ.

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∫–æ–Ω–µ—á–Ω–æ–π —Ç–æ—á–∫–æ–π (enpoint) Next.js API

–î–∞–≤–∞–π—Ç–µ —Å—Ä–∞–≤–Ω–∏–º –∫–æ–Ω–µ—á–Ω—É—é —Ç–æ—á–∫—É (endpoint) Next.js API —Å –ø—Ä–æ—Ü–µ–¥—É—Ä–æ–π tRPC. –î–æ–ø—É—Å—Ç–∏–º, –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å –æ–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –Ω–∞—à–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –≤–µ—Ä–Ω—É—Ç—å –µ–≥–æ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥. –ú—ã –º–æ–≥–ª–∏ –±—ã –Ω–∞–ø–∏—Å–∞—Ç—å –∫–æ–Ω–µ—á–Ω—É—é —Ç–æ—á–∫—É (endpoint) Next.js API —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```ts:pages/api/users/[id].ts
import { type NextApiRequest,
 type NextApiResponse } from "next";

import { prisma } from "../../../server/db";

const userByIdHandler = async (req: NextApiRequest, res: NextApiResponse) => {
  if (req.method !== "GET") {
    return res.status(405).end();
  }

  const { id } = req.query;

  if (!id || typeof id !== "string") {
    return res.status(400).json({ error: "Invalid id" });
  }

  const examples = await prisma.example.findFirst({
    where: {
      id,
    },
  });

  res.status(200).json(examples);
};

export default userByIdHandler;
```

```ts:pages/users/[id].tsx
import { useState, useEffect } from "react";
import { useRouter } from "next/router";

const UserPage = () => {
  const router = useRouter();
  const { id } = router.query;

  const [user, setUser] = useState(null);
  useEffect(() => {
    fetch(`/api/user/${id}`)
      .then((res) => res.json())
      .then((data) => setUser(data));
  }, [id]);
};
```

–°—Ä–∞–≤–Ω–∏—Ç–µ —ç—Ç–æ —Å –ø—Ä–∏–º–µ—Ä–æ–º tRPC –≤—ã—à–µ –∏ –≤—ã —É–≤–∏–¥–∏—Ç–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–π–º—É—â–µ—Å—Ç–≤–∞ tRPC:

- –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã —É–∫–∞–∑—ã–≤–∞—Ç—å URL –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –Ω–µ—É–¥–æ–±–Ω—ã–º –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏, –µ—Å–ª–∏ –≤—ã —á—Ç–æ-—Ç–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ, –≤–∞—à –≤–µ—Å—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä - —ç—Ç–æ –æ–±—ä–µ–∫—Ç —Å –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º.
- –í–∞–º –Ω–µ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, –∫–∞–∫–æ–π HTTP –º–µ—Ç–æ–¥ –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω.
- –í–∞–º –Ω–µ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –∏–ª–∏ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–æ—Ü–µ–¥—É—Ä–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ Zod –ø–æ–∑–∞–±–æ—Ç–∏—Ç—Å—è –æ–± —ç—Ç–æ–º.
- –í–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞, –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–ª–∏ –æ–±—ä–µ–∫—Ç, –∫–∞–∫ –≤ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ TypeScript.
- –í—ã–∑—ã–≤–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä—É –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ, –≤—ã –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç–µ –Ω–∏–∫–∞–∫–æ–≥–æ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤.

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å–Ω–∏–ø–ø–µ—Ç—ã

–ó–¥–µ—Å—å –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–Ω–∏–ø–ø–µ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è.

### –í–∫–ª—é—á–µ–Ω–∏–µ CORS

–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞—à API —Å –¥—Ä—É–≥–æ–≥–æ –¥–æ–º–µ–Ω–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ React Native, –≤–∞–º –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –≤–∫–ª—é—á–∏—Ç—å CORS:

```ts:pages/api/trpc/[trpc].ts
import { type NextApiRequest,
 type NextApiResponse } from "next";

import { createNextApiHandler } from "@trpc/server/adapters/next";
import { appRouter } from "~/server/api/root";
import { createTRPCContext } from "~/server/api/trpc";
import cors from "nextjs-cors";

const handler = async (req: NextApiRequest, res: NextApiResponse) => {
  // Enable cors
  await cors(req, res);

  // Create and call the tRPC handler
  return createNextApiHandler({
    router: appRouter,
    createContext: createTRPCContext,
  })(req, res);
};

export default handler;
```

### –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ - —ç—Ç–æ –∫–æ–≥–¥–∞ –º—ã –æ–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ API-–∑–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è. –≠—Ç–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ª—É—á—à–∏–π –æ–ø—ã—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –Ω–µ –¥–æ–ª–∂–µ–Ω –∂–¥–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è API-–∑–∞–ø—Ä–æ—Å–∞, –ø—Ä–µ–∂–¥–µ —á–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Ç–æ–±—Ä–∞–∑–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è. –û–¥–Ω–∞–∫–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Ü–µ–Ω—è—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, –¥–æ–ª–∂–Ω—ã –∏–∑–±–µ–≥–∞—Ç—å –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∏ –Ω–µ —è–≤–ª—è—é—Ç—Å—è ¬´–∏—Å—Ç–∏–Ω–Ω—ã–º¬ª –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –±—ç–∫–µ–Ω–¥–∞. –í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –±–æ–ª—å—à–µ –≤ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ React Query](https://tanstack.com/query/v4/docs/guides/optimistic-updates).

```tsx
const MyComponent = () => {
  const listPostQuery = api.post.list.useQuery();

  const utils = api.useContext();
  const postCreate = api.post.create.useMutation({
    async onMutate(newPost) {
      // Cancel outgoing fetches (so they don't overwrite our optimistic update)
      await utils.post.list.cancel();

      // Get the data from the queryCache
      const prevData = utils.post.list.getData();

      // Optimistically update the data with our new post
      utils.post.list.setData(undefined, (old) => [...old, newPost]);

      // Return the previous data so we can revert if something goes wrong
      return { prevData };
    },
    onError(err, newPost, ctx) {
      // If the mutation fails, use the context-value from onMutate
      utils.post.list.setData(undefined, ctx.prevData);
    },
    onSettled() {
      // Sync with server once mutation has settled
      utils.post.list.invalidate();
    },
  });
};
```

### –ü—Ä–æ—Å—Ç–æ–π –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¢–µ—Å—Ç

–ó–¥–µ—Å—å –ø—Ä–µ–≤–µ–¥–µ–Ω –ø—Ä–æ—Å—Ç–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç [Vitest](https://vitest.dev), —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤–∞—à –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä tRPC —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º, –ø–∞—Ä—Å–µ—Ä –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤—ã–≤–æ–¥–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É.

```ts
import { type inferProcedureInput } from "@trpc/server";
import { createInnerTRPCContext } from "~/server/api/trpc";
import { appRouter, type AppRouter } from "~/server/api/root";
import { expect, test } from "vitest";

test("example router", async () => {
  const ctx = await createInnerTRPCContext({ session: null });
  const caller = appRouter.createCaller(ctx);

  type Input = inferProcedureInput<AppRouter["example"]["hello"]>;
  const input: Input = {
    text: "test",
  };

  const example = await caller.example.hello(input);

  expect(example).toMatchObject({ greeting: "Hello test" });
});
```

## –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

| –†–µ—Å—É—Ä—Å                                | –°—Å—ã–ª–∫–∞                                                  |
| ------------------------------------- | ------------------------------------------------------- |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ tRPC                  | https://www.trpc.io                                     |
| –ù–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è tRPC | https://github.com/trpc/trpc/tree/next/examples         |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è React Query              | https://tanstack.com/query/v4/docs/adapters/react-query |
